name: ci

on:
  pull_request:
  
  workflow_dispatch:
    inputs:
      version:
        description: 'nwaku version to run'
        required: true 
        type: string
        default: "v0.11"

jobs:
  node:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Get nwaku
        shell: bash
        run: |
          mkdir -p nwaku/build
          cd nwaku
          wget "https://github.com/status-im/nwaku/releases/download/${{ inputs.version }}/nim-waku-ubuntu-latest.tar.gz"
          tar xavf nim-waku-ubuntu-latest.tar.gz
      - name: Run wakunode2 with no options
        shell: bash
        run: |
          uname -a
          cd nwaku/build
          timeout 30s ./wakunode2
      
